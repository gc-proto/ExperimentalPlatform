<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE xml>
<!-- To be defined in parent configuration or elsewhere (e.g., variables 
	file): $lang = "en" or "fr" $workdir = "path to working directory" $solrURL 
	= "Solr URL" -->
<crawler id="Covid-19 Manual Crawler ${lang}">
	
	<startURLs stayOnDomain="true" stayOnPort="false"
		stayOnProtocol="false">
		<url>https://www.cbsa-asfc.gc.ca/services/covid/menu-fra.html</url>
		<url>https://covid-prestations.alpha.canada.ca/fr/debut</url>
		<url>https://www.canada.ca/fr/immigration-refugies-citoyennete/services/coronavirus-covid19.html</url>
		<url>https://www.tc.gc.ca/fr/services/aviation/services-aeriens-commerciaux/formation-regulateurs-vol-manuels-exploitation/bulletin-regulateur-verificateur-agree-rva-no-01-20-mesures-reponse-nouveau-coronavirus-covid-19.html</url>
		<url>https://www.international.gc.ca/development-developpement/partners-partenaires/bt-oa/guidance-covid-guide.aspx?lang=fra</url>
		<url>https://www.csc-scc.gc.ca/001/006/001006-1014-fr.shtml</url>
		<url>https://www.tc.gc.ca/fra/tmd/certificats-temporaires.html</url>
		<url>https://www.canada.ca/content/dam/tbs-sct/documents/covid-19/20200324-fra.pdf</url>
		<url>https://www.tc.gc.ca/fr/initiatives/covid-19-mesures-mises-a-jour-lignes-directrices-tc/covid-19-document-orientation-transporteurs-aeriens-gestion-voyageurs-procedure-enregistrement-aeroports-transfrontaliers-etats-unis.html</url>
		<url>https://www.tc.gc.ca/Aviationcivile/servreg/Affaires/exemptions/docs/fr/3269.htm</url>
		<url>https://www.canada.ca/fr/services/science.html</url>
		<url>https://www.destinationcanada.com/fr/mises-a-jour-sur-le-coronavirus</url>
		<url>https://www.canada.ca/content/dam/tbs-sct/documents/PSTFP-Avis-gen%C3%A9ral-sante-travail-COVID-19-03-15-2020-fra.pdf</url>
		<url>https://www.international.gc.ca/world-monde/international_relations-relations_internationales/information_development_partners-information_partenaires_developpement.aspx?lang=eng</url>
		<url>https://www.tc.gc.ca/Aviationcivile/servreg/Affaires/exemptions/docs/fr/3249.htm</url>
		<url>https://www.canada.ca/fr/services-autochtones-canada.html</url>
		<url>https://www.canada.ca/fr/ministere-defense-nationale/services/operations/operations-militaires/operations-en-cours/liste.html</url>
		<url>https://www.tc.gc.ca/fra/securitemaritime/bulletins-2020-07-fra.htm</url>
		<url>https://www.tc.gc.ca/fr/initiatives/covid-19-mesures-mises-a-jour-lignes-directrices-tc/mesures-aerien.html</url>
		<url>https://www.tc.gc.ca/Aviationcivile/servreg/Affaires/exemptions/docs/fr/3254.htm</url>
		<url>http://www.agr.gc.ca/fra/maladie-a-coronavirus-covid-19-information-pour-lindustrie/?id=1584732749543</url>
		<url>https://www.tc.gc.ca/Aviationcivile/servreg/Affaires/exemptions/docs/fr/3246.htm</url>
		<url>https://www.tc.gc.ca/fr/initiatives/covid-19-mesures-mises-a-jour-lignes-directrices-tc/covid-19-lettre-industrie-aeronautique.html</url>
		<url>https://www.cbsa-asfc.gc.ca/menu-fra.html</url>
		<url>https://www.wd-deo.gc.ca/fra/20052.asp</url>
		<url>https://www.tc.gc.ca/fr/initiatives/covid-19-mesures-mises-a-jour-lignes-directrices-tc/arrete-urgence-imposant-certaines-restrictions-batiments-passagers-raison-maladie-coronoavirus-2019.html</url>
		<url>https://www.tc.gc.ca/fr/services/ferroviaire/exemptions-temporaires-refc-concernant-securite-voie-reglement-normes-competence-employes-ferroviare.html</url>
		<url>https://www.sac-isc.gc.ca/fra/1584819394157/1584819418553</url>
		<url>https://www.tc.gc.ca/Aviationcivile/servreg/Affaires/exemptions/docs/fr/3257.htm</url>
		<url>https://www.tc.gc.ca/fra/securiteautomobile/confirmation-emploi-travailleurs-essentiels-transport.html</url>
		<url>https://www.canada.ca/fr/services/environnement.html</url>
		<url>https://www.canada.ca/fr/services/entreprises.html</url>
		<url>https://www.tc.gc.ca/fr/initiatives/covid-19-mesures-mises-a-jour-lignes-directrices-tc/covid-19-document-orientation-transporteurs-aeriens-gestion-voyageurs-procedure-enregistrement-aeroports-internationaux.html</url>
		<url>https://cihr-irsc.gc.ca/f/51868.html</url>
		<url>https://www.tc.gc.ca/fr/services/aviation/services-aeriens-commerciaux/programme-pilote-verificateur-agree-programme-avance-qualification/bulletin-programme-pilote-verificateur-agree-programme-avance-qualification/bulletin-03-20.html</url>
		<url>https://www.tc.gc.ca/fr/services/maritime/documents/20-AA-35-HEALTH_REPORTING_SHIPS_17X11_FR_acc.pdf</url>
		<url>https://www.international.gc.ca/covid-19-loan-pret/form-formulaire.aspx?lang=fra</url>
		<url>https://www.tc.gc.ca/fra/medias/arrete-urgence-no-2-visant-interdire-certaines-personnes-embarquer-sur-vols-canada-raison-covid-19.html</url>
		<url>https://www.tc.gc.ca/fr/initiatives/covid-19-mesures-mises-a-jour-lignes-directrices-tc/exemptions-aviation.html</url>
		<url>https://www.canada.ca/fr/ministere-defense-nationale.html</url>
		<url>https://www.tc.gc.ca/Aviationcivile/servreg/Affaires/exemptions/docs/fr/3250.htm</url>
		<url>https://www.canada.ca/fr/sante-publique/services/maladies.html</url>
		<url>https://www.tc.gc.ca/fra/securitemaritime/bulletins-2020-04-fra.htm</url>
		<url>https://www.tc.gc.ca/fra/securiteautomobile/lignes-directrices-federales-assurer-securite-conducteurs-limiter-propagation-covid-19-exploitation-vehicules.html</url>
		<url>https://www.tc.gc.ca/fra/securitemaritime/bulletins-2020-10-fra.htm</url>
		<url>https://www.canada.ca/fr/services/culture.html</url>
		<url>https://www.sac-isc.gc.ca/fra/1581964230816/1581964277298</url>
		<url>https://www.canada.ca/fr/agence-revenu/services/prestations/faire-demander-pcu-aupres-arc.html</url>
		<url>https://www.canada.ca/fr/ministere-defense-nationale/services/operations/operations-militaires/operations-en-cours/laser.html</url>
		<url>https://www.rcaanc-cirnac.gc.ca/fra/1461766373625/1556203056093</url>
		<url>https://www.tc.gc.ca/fr/initiatives/covid-19-mesures-mises-a-jour-lignes-directrices-tc/document-information-exigences-securite-covid-19-exploitants-navires-passagers-commerciaux-traversiers.html</url>
		<url>https://www.canada.ca/fr/services/police.html</url>
		<url>http://www.ic.gc.ca/eic/site/cipointernet-internetopic.nsf/fra/wr04766.html</url>
		<url>https://www.cmhc-schl.gc.ca/fr/media-newsroom/coronavirus-update</url>
		<url>https://www.canada.ca/content/dam/tbs-sct/documents/covid-annex-a-fra.pdf</url>
		<url>https://www.canada.ca/fr/sante-publique/services/grippe-influenza/plans-intervention-en-cas-de-pandemie.html</url>
		<url>http://www.dfo-mpo.gc.ca/covid19/industry-industrie/index-fra.html</url>
		<url>https://www.canada.ca/fr/sante-publique/services/grippe-influenza/preparation-canada-cas-grippe-pandemique-guide-planification-secteur-sante.html</url>
		<url>https://www.csc-scc.gc.ca/001/006/001006-1004-fr.shtml</url>
		<url>https://www.canada.ca/fr/services/defense.html</url>
		<url>https://www.tc.gc.ca/fr/initiatives/covid-19-mesures-mises-a-jour-lignes-directrices-tc/document-orientation-pour-transporteurs-aeriens.html</url>
		<url>https://www.ic.gc.ca/eic/site/bsf-osb.nsf/fra/br04232.html</url>
		<url>https://www.statcan.gc.ca/fra/covid19</url>
		<url>https://www.inspection.gc.ca/covid-19/informations-de-l-acia-pour-l-industrie/fra/1584462704366/1584462704709</url>
		<url>https://www.tc.gc.ca/fr/initiatives/covid-19-mesures-mises-a-jour-lignes-directrices-tc/covid-19-document-orientation-intention-navires-passagers-operateurs-traversiers.html</url>
		<url>https://www.tc.gc.ca/Aviationcivile/servreg/Affaires/exemptions/docs/fr/3256.htm</url>
		<url>https://www.csc-scc.gc.ca/001/006/001006-1017-fr.shtml</url>
		<url>https://www.canada.ca/content/dam/tbs-sct/documents/covid-19/20200321-fra.pdf</url>
		<url>https://www.canada.ca/fr/emploi-developpement-social/ministere/avis.html</url>
		<url>https://www.tc.gc.ca/fra/medias/arrete-urgence-no-5-visant-intere-direcertaines-personnes-embarquer-vols-destination-canada-covid-19.html</url>
		<url>https://www.canada.ca/fr/relations-couronne-autochtones-affaires-nord.html</url>
		<url>https://www.tc.gc.ca/fra/securitemaritime/bulletins-2020-06-fra.htm</url>
		<url>https://www.fcc-fac.ca/fr/covid-19/program-details.html</url>
		<url>https://www.tc.gc.ca/fr/initiatives/covid-19-mesures-mises-a-jour-lignes-directrices-tc/guide-covid-19-intention-industrie-aeronautique-canada.html</url>
		<url>https://www.canada.ca/fr/services/impots.html</url>
		<url>https://www.tc.gc.ca/Aviationcivile/servreg/Affaires/exemptions/docs/fr/3245.htm</url>
		<url>https://www.tc.gc.ca/media/documents/tdg-eng/0750-fra-Transportation_of_Dangerous_Directorate_Transport_Canada.pdf</url>
		<url>https://www.tc.gc.ca/Aviationcivile/servreg/Affaires/exemptions/docs/fr/3259.htm</url>
		<url>https://dec.canada.ca/fra/covid-19.html</url>
		<url>https://www.canada.ca/content/dam/tbs-sct/documents/CHRO-message-03-15-2020-eng.pdf</url>
		<url>https://www.rcaanc-cirnac.gc.ca/fra/1584656849722/1584716136299</url>
		<url>https://www.canada.ca/fr/services/prestations.html</url>
		<url>https://www.grainscanada.gc.ca/fr/COVID-19/</url>
		<url>https://www.canada.ca/content/dam/tbs-sct/documents/FAQ-COVID-19-fra.docx</url>
		<url>https://www.tc.gc.ca/Aviationcivile/servreg/Affaires/exemptions/docs/fr/3252.htm</url>
		<url>https://www.tc.gc.ca/Aviationcivile/Servreg/Affaires/exemptions/docs/fr/3247.htm</url>
		<url>https://www.tc.gc.ca/fr/services/ferroviaire/exemption-temporaire-reglement-medical-postes-essentiels-securite-ferroviaire.html</url>
		<url>https://www.canada.ca/content/dam/tbs-sct/documents/covid-19/20200228-fra.pdf</url>
		<url>https://www.canada.ca/content/dam/tbs-sct/documents/covid-19/20200319-fra.pdf</url>
		<url>https://www.tc.gc.ca/media/documents/tmd-fra/0751-fra-Transportation_of_Dangerous_Directorate_Transport_Canada.pdf</url>
		<url>https://www.deleguescommerciaux.gc.ca/campaign-campagne/commerce-international-covid-19-international-trade.aspx?lang=fra</url>
		<url>https://www.tc.gc.ca/fr/services/aviation/aptitudes-physiques-mentales-aviation/covid-19-mise-jour-sur-les-certificat-medicaux-aviation.html</url>
		<url>https://www.tc.gc.ca/fra/securitemaritime/bulletins-2020-03-fra.htm</url>
		<url>https://www.ic.gc.ca/eic/site/099.nsf/fra/00023.html</url>
		<url>http://www.ic.gc.ca/eic/site/mc-mc.nsf/fra/lm04942.html</url>
		<url>http://gazette.gc.ca/rp-pr/p2/2020/2020-04-01/html/sor-dors54-fra.html</url>
		<url>https://www.tc.gc.ca/fra/medias/arrete-urgence-no-3-visant-interdire-certaines-personnes-embarquer-vols-destination-canada-raison-covid-19.html</url>
		<url>https://www.canada.ca/content/dam/tbs-sct/documents/CHRO-message-03-13-2020.pdf</url>
		<url>https://www.ic.gc.ca/eic/site/icgc.nsf/fra/07677.html</url>
		<url>https://www.canada.ca/fr/services/transport.html</url>
		<url>https://www.tc.gc.ca/fra/securiteferroviaire/arrete-vertu-article-3201-loi-sur-la-securite-ferroviaire-raison-covid-19-mo-20-04.html</url>
		<url>https://www.sac-isc.gc.ca/fra/1584656849722/1584656919871</url>
		<url>https://www.tc.gc.ca/Aviationcivile/servreg/Affaires/exemptions/docs/fr/3255.htm</url>
		<url>https://www.canada.ca/fr/services/sante.html</url>
		<url>https://www.sac-isc.gc.ca/fra/1583781906998/1583781926813</url>
		<url>https://www.canada.ca/fr/services/finance.html</url>
		<url>https://www.sac-isc.gc.ca/fra/1584456952392/1584456999460</url>
		<url>https://www.canada.ca/content/dam/tbs-sct/documents/covid-19/20200323-fra.pdf</url>
		<url>https://www.canada.ca/content/dam/phac-aspc/documents/services/diseases/2019-novel-coronavirus-infection/health-professionals/2019-nCoV-case-report-form-fr.pdf</url>
		<url>https://www.canada.ca/fr/sante-publique/services/agents-pathogenes-voies-respiratoires-emergents/protocole-enquete-microbiologique-concernant-infections-respiratoires-aigues-severes-iras.html</url>
		<url>https://www.international.gc.ca/world-monde/index.aspx?lang=fra</url>
		<url>https://www.canada.ca/content/dam/tbs-sct/documents/covid-19/20200225-fra.pdf</url>
		<url>https://www.cfc-swc.gc.ca/fun-fin/shelters-refuges-fr.html</url>
		<url>https://www.tc.gc.ca/fra/tmd/covid-19-exigences-relatives-transport-securitaire-matieres-infectieuses-classe-6-2.html</url>
		<url>https://www.ic.gc.ca/eic/site/cipointernet-internetopic.nsf/fra/wr04764.html</url>
		<url>https://www.tc.gc.ca/fr/services/aviation/centre-reference/alertes-securite/covid-19-orientation-provisoire-exploitants-equipage-aviation-commerciale.html</url>
		<url>https://www.csc-scc.gc.ca/001/006/001006-1003-fr.shtml</url>
		<url>https://www.tc.gc.ca/fr/initiatives/covid-19-mesures-mises-a-jour-lignes-directrices-tc.html</url>
		<url>https://www.tc.gc.ca/fr/services/maritime/documents/assurer-votre-securite-travail_acc.pdf</url>
		<url>https://www.ic.gc.ca/eic/site/bsf-osb.nsf/fra/br04235.html</url>
		<url>https://www.canada.ca/fr/services/sante/publications/maladies-et-affections.html</url>
		<url>https://www.tc.gc.ca/Aviationcivile/servreg/Affaires/exemptions/docs/fr/3248.htm</url>
		<url>https://www.ic.gc.ca/eic/site/cipointernet-internetopic.nsf/fra/wr04763.html</url>
		<url>https://www.sac-isc.gc.ca/fra/1319805325971/1572459825339</url>
		<url>https://www.canada.ca/content/dam/tbs-sct/documents/covid-19/20200322-fra.pdf</url>
		<url>https://www.tc.gc.ca/Aviationcivile/servreg/Affaires/exemptions/docs/fr/3253.htm</url>
		<url>https://www.tc.gc.ca/fra/securitemaritime/bulletins-2020-05-fra.htm</url>
		<url>https://www.ic.gc.ca/eic/site/099.nsf/fra/00022.html</url>
		<url>https://www.sac-isc.gc.ca/fra/1585189335380/1585189357198</url>
		<url>https://www.international.gc.ca/world-monde/funding-financement/funding_tools-outils_de_financement.aspx?lang=fra</url>
		<url>https://www.international.gc.ca/covid-19-loan-pret/</url>
		<url>https://www.ic.gc.ca/eic/site/cipointernet-internetopic.nsf/fra/wr04762.html</url>
		<url>https://www.rcmp-grc.gc.ca/fr/covid-19</url>
		<url>https://www.tc.gc.ca/fr/services/ferroviaire/covid-19-document-orientation-intention-compagnies-chemin-fer-transportant-voyageurs.html</url>
		<url>https://cyber.gc.ca/fr/nouvelles/assurer-sa-securite-en-ligne-pendant-la-periode-disolement-liee-la-covid-19</url>
		<url>https://www.canada.ca/content/dam/tbs-sct/documents/covid-annex-b-fra.pdf</url>
		<url>https://www.btb.termiumplus.gc.ca/publications/covid19-fra.html</url>
		<url>https://www.canada.ca/content/dam/tbs-sct/documents/CHRO-message-03-09-2020.pdf</url>
		<url>https://www.tc.gc.ca/fra/medias/arrete-urgence-visant-interdire-certaines-personnes-embarquer-vols-au-canada-raison-covid-19.html</url>
		<url>https://www.tc.gc.ca/Aviationcivile/servreg/Affaires/exemptions/docs/fr/3258.htm</url>
		<url>https://www.canada.ca/fr/services/entreprises/maintenirfairecroitreameliorerentreprise/aide-manufacturiers.html</url>
		<url>https://conseildesarts.ca/information-covid-19</url>
		<url>https://www.canada.ca/fr/patrimoine-canadien.html</url>
	</startURLs>
	<userAgent>TreasuryBoard/Covid crawler</userAgent>

	<workDir>$workdir</workDir>

	<!-- We go unlimited depth to make sure we follow all the pagination. - 
		We are filtering out every that does not come from search results. -->
	<maxDepth>0</maxDepth>

	<!-- Aggressiveness: no point being too aggressive here. -->
	<numThreads>2</numThreads>
	<delay default="500" ignoreRobotsCrawlDelay="false" scope="site" />

	<!-- Because we are explicit in the pages we want, we ignore most site crawling 
		directives. -->
	<robotsMeta ignore="true" />
	<robotsTxt ignore="true" />
	<canonicalLinkDetector ignore="true" />
	<sitemapResolverFactory ignore="true" />

	<!-- If no longer found in search results, do not keep it. -->
	<orphansStrategy>PROCESS</orphansStrategy>

	<!-- Useful to uncomment for troubleshooting: -->
	<!-- <maxDocuments>12</maxDocuments> <metadataChecksummer disabled="true" 
		/> <documentChecksummer disabled="true" /> -->

	<!-- Extract/follow links from search result only. -->
	<linkExtractors>
		<extractor
			class="ca.canada.treasury.testbed.extractor.NullExtractor"
			ignoreNofollow="true">
			<extractBetween>
				<start><![CDATA[<section class="results.*?">]]></start>
				<end><![CDATA[</section>]]></end>
			</extractBetween>
			<extractBetween>
				<start><![CDATA[<ul class="pagination.*?">]]></start>
				<end><![CDATA[</ul>]]></end>
			</extractBetween>
		</extractor>

	</linkExtractors>
	<!-- We only index pages coming from search results, except other result 
		- pages. -->
	<documentFilters>
		<filter
			class="com.norconex.collector.core.filter.impl.RegexReferenceFilter"
			onMatch="include">
			.*
		</filter>
	</documentFilters>

	<importer>

		<preParseHandlers>

			<!-- Store a flag if the page contains an alert about COVID-19 -->
			<tagger
				class="com.norconex.importer.handler.tagger.impl.DOMTagger">
				<dom
					selector=".alert.alert-warning, .alert.alert-danger, .bg-warning"
					extract="text" toField="alert_tmp" />
			</tagger>
			<tagger
				class="com.norconex.importer.handler.tagger.impl.ReplaceTagger">
				<replace fromField="alert_tmp" toField="alert" regex="true"
					wholeMatch="true">
					<fromValue>^.*(covid-19|coronavirus|cerb|pcu|Canada Emergency
						Response Benefit|Prestation canadienne d'urgence).*$</fromValue>
					<toValue>true</toValue>
				</replace>
			</tagger>

			<!-- Extract all H2 and bread crumb levels 2, 3, 4 if they exist: -->
			<tagger
				class="com.norconex.importer.handler.tagger.impl.DOMTagger">
				<dom selector=".breadcrumb li:eq(1) a" extract="text"
					toField="bc2_name" overwrite="true" />
				<dom selector=".breadcrumb li:eq(1) a" extract="attr(href)"
					toField="bc2_url" overwrite="true" />
				<dom selector=".breadcrumb li:eq(2) a" extract="text"
					toField="bc3_name" overwrite="true" />
				<dom selector=".breadcrumb li:eq(2) a" extract="attr(href)"
					toField="bc3_url" overwrite="true" />
				<dom selector=".breadcrumb li:eq(3) a" extract="text"
					toField="bc4_name" overwrite="true" />
				<dom selector=".breadcrumb li:eq(3) a" extract="attr(href)"
					toField="bc4_url" overwrite="true" />
			</tagger>

			<!-- Remove portions of a page we do not care about (e.g., "noise"): -->
			<transformer
				class="com.norconex.importer.handler.transformer.impl.StripBetweenTransformer"
				inclusive="true">
				<restrictTo field="document.contentType">text/html</restrictTo>
				<stripBetween>
					<start><![CDATA[<ul id="wb-tphp">]]></start>
					<end><![CDATA[</ul>]]></end>
				</stripBetween>
				<stripBetween>
					<start><![CDATA[<header\b.*?>]]></start>
					<end><![CDATA[</header>]]></end>
				</stripBetween>
				<stripBetween>
					<start><![CDATA[<footer\b.*?>]]></start>
					<end><![CDATA[</footer>]]></end>
				</stripBetween>
				<stripBetween>
					<start><![CDATA[<nav\b.*?>]]></start>
					<end><![CDATA[</nav>]]></end>
				</stripBetween>
			</transformer>

			<!-- We extract H2 after we cleanded up some portions (headfoot). -->
			<tagger
				class="com.norconex.importer.handler.tagger.impl.DOMTagger">
				<dom selector="h2" extract="text" toField="h2" overwrite="false" />
			</tagger>

		</preParseHandlers>

		<postParseHandlers>

			<!-- - TODO: Maybe store flag if covid-19 or coronavirus is found in - 
				body after alert is taken out (to know if found in alert only). -->

			<tagger
				class="com.norconex.importer.handler.tagger.impl.FieldReportTagger"
				maxSamples="5" withHeaders="true" withOccurences="true"
				truncateSamplesAt="512" file="${workdir}/discovered-fields.csv" />



			<tagger
				class="com.norconex.importer.handler.tagger.impl.ReplaceTagger">
				<replace fromField="document.reference" toField="domain"
					regex="true">
					<fromValue>https://(.*?)/.*$</fromValue>
					<toValue>$1</toValue>
				</replace>
			</tagger>

			<tagger
				class="com.norconex.importer.handler.tagger.impl.ReplaceTagger">
				<replace fromField="title" regex="true">
					<fromValue>(.*?)\s*-?\s*canada.ca</fromValue>
					<toValue>$1</toValue>
				</replace>
			</tagger>

			<tagger
				class="com.norconex.importer.handler.tagger.impl.RenameTagger">
				<rename fromField="document.contentFamily" toField="filetype"
					overwrite="true" />
				<rename fromField="dcterms.subject" toField="subject"
					overwrite="true" />
				<rename fromField="dcterms.audience" toField="audience"
					overwrite="true" />
				<rename fromField="description" toField="desc"
					overwrite="true" />
				<rename fromField="dcterms.type" toField="category"
					overwrite="true" />
			</tagger>

			<tagger
				class="com.norconex.importer.handler.tagger.impl.SplitTagger">
				<split fromField="audience" regex="true">
					<separator>\s*,\s*</separator>
				</split>
				<split fromField="keywords" regex="true">
					<separator>\s*,\s*</separator>
				</split>
				<split fromField="category" regex="true">
					<separator>\s*;\s*</separator>
				</split>
				<split fromField="subject" regex="true">
					<separator>\s*;\s*</separator>
				</split>
			</tagger>

			<!-- Consider a few "modified" dates, but keep the first one only: -->
			<tagger
				class="com.norconex.importer.handler.tagger.impl.DateFormatTagger"
				fromField="dcterms.modified" toField="lastmodified"
				toFormat="yyyy-MM-dd'T00:00:00.000Z'">
				<fromFormat>yyyy-MM-dd</fromFormat>
			</tagger>
			<tagger
				class="com.norconex.importer.handler.tagger.impl.DateFormatTagger"
				fromField="Last-Modified" toField="lastmodified"
				toFormat="yyyy-MM-dd'T'HH:mm:ss.SSS'Z'">
				<fromFormat>EEE, dd MMM yyyy HH:mm:ss zzz</fromFormat>
				<fromFormat>EPOCH</fromFormat>
			</tagger>
			
			<tagger
				class="com.norconex.importer.handler.tagger.impl.ForceSingleValueTagger">
				<singleValue field="lastmodified" action="keepFirst" />
				<singleValue field="alert" action="keepFirst" />
			</tagger>
			
			<filter
				class="com.norconex.importer.handler.filter.impl.DateMetadataFilter"
				onMatch="include" field="lastmodified" format="yyyy-MM-dd'T00:00:00.000Z'">
				 <condition operator="ge" date="TODAY-1Y" />
      			<condition operator="lt" date="TODAY" />
			</filter>

			<tagger
				class="com.norconex.importer.handler.tagger.impl.CurrentDateTagger"
				field="lastcrawled" format="yyyy-MM-dd'T'HH:mm:ss.SSS'Z'" />

			<tagger
				class="com.norconex.importer.handler.tagger.impl.CharacterCaseTagger">
				<characterCase fieldName="author" type="lower"
					applyTo="field" />
				<characterCase fieldName="keywords" type="lower"
					applyTo="field" />
				<characterCase fieldName="title" type="lower"
					applyTo="field" />
			</tagger>

			<tagger
				class="com.norconex.importer.handler.tagger.impl.ConstantTagger"
				onConflict="replace">
				<constant name="language">${lang}</constant>
			</tagger>

			<tagger
				class="com.norconex.importer.handler.tagger.impl.KeepOnlyTagger">
				<fields>
					domain,
					language,
					filetype,
					lastmodified,
					lastcrawled,
					author,
					subject,
					audience,
					category,
					keywords,
					title,
					desc,
					h2,
					bc2_name,
					bc2_url,
					bc3_name,
					bc3_url,
					bc4_name,
					bc4_url,
					alert
				</fields>
			</tagger>

			<tagger
				class="com.norconex.importer.handler.tagger.impl.TruncateTagger"
				fromField="title" maxLength="5096" overwrite="true" suffix="[...]" />
			<tagger
				class="com.norconex.importer.handler.tagger.impl.TruncateTagger"
				fromField="author" maxLength="5096" overwrite="true" suffix="[...]" />
			<tagger
				class="com.norconex.importer.handler.tagger.impl.TruncateTagger"
				fromField="subject" maxLength="5096" overwrite="true" suffix="[...]" />
			<tagger
				class="com.norconex.importer.handler.tagger.impl.TruncateTagger"
				fromField="audience" maxLength="5096" overwrite="true"
				suffix="[...]" />
			<tagger
				class="com.norconex.importer.handler.tagger.impl.TruncateTagger"
				fromField="category" maxLength="5096" overwrite="true"
				suffix="[...]" />
			<tagger
				class="com.norconex.importer.handler.tagger.impl.TruncateTagger"
				fromField="keywords" maxLength="5096" overwrite="true"
				suffix="[...]" />
			<tagger
				class="com.norconex.importer.handler.tagger.impl.TruncateTagger"
				fromField="desc" maxLength="5096" overwrite="true" suffix="[...]" />
			<tagger
				class="com.norconex.importer.handler.tagger.impl.TruncateTagger"
				fromField="h2" maxLength="5096" overwrite="true" suffix="[...]" />

			<transformer
				class="com.norconex.importer.handler.transformer.impl.ReplaceTransformer">
				<replace>
					<fromValue>(\s\s\s)\s+</fromValue>
					<toValue>$1</toValue>
				</replace>
				<replace>
					<fromValue>^\s+</fromValue>
					<toValue></toValue>
				</replace>
				<replace>
					<fromValue>\s+$</fromValue>
					<toValue></toValue>
				</replace>
			</transformer>

		</postParseHandlers>

	</importer>

	<committer class="com.norconex.committer.solr.SolrCommitter">
		<solrURL>${solrURL}</solrURL>
		<queueDir>${workdir}/solrcommitter-queue_${lang}</queueDir>
		<queueSize>20</queueSize>
		<commitBatchSize>20</commitBatchSize>
		<maxRetries>3</maxRetries>
		<maxRetryWait>10 seconds</maxRetryWait>
	</committer>
	<!-- <committer class="com.norconex.committer.core.impl.JSONFileCommitter"> 
		<directory>${workdir}/crawledfiles_${lang}</directory> <pretty>true</pretty> 
		</committer> -->

</crawler>